<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>Better Monads</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" pltdoc="x">Better Monads</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#(part._.Usage)" class="tocviewlink" pltdoc="x">Usage</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#(part._.Other_.Forms_and_.Functions)" class="tocviewlink" pltdoc="x">Other Forms and Functions</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#(part._.Functions_.Values)" class="tocviewlink" pltdoc="x">Functions/<span class="mywbr"> </span>Values</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#(part._.Structures)" class="tocviewlink" pltdoc="x">Structures</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#(part._.Syntax)" class="tocviewlink" pltdoc="x">Syntax</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#(part._.Conclusions)" class="tocviewlink" pltdoc="x">Conclusions</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#(part._.Usage)" class="tocsubseclink" pltdoc="x">Usage</a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#(part._mlet_)" class="tocsubseclink" pltdoc="x">mlet*</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#(part._.Working_with_a_.Monad)" class="tocsubseclink" pltdoc="x">Working with a Monad</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#(part._.Defining_.Additional_.Monads)" class="tocsubseclink" pltdoc="x">Defining Additional Monads</a></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="#(part._.Lagniappe__.Bonus_.Features_)" class="tocsubseclink" pltdoc="x">Lagniappe (Bonus Features)</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#(part._.Other_.Forms_and_.Functions)" class="tocsubseclink" pltdoc="x">Other Forms and Functions</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#(part._monadic-do)" class="tocsubseclink" pltdoc="x">monadic-<wbr></wbr>do</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#(part._.Bundled_.Monads)" class="tocsubseclink" pltdoc="x">Bundled Monads</a></td></tr><tr><td><span class="tocsublinknumber">2.2.1<tt>&nbsp;</tt></span><a href="#(part._.The_.List_.Monad)" class="tocsubseclink" pltdoc="x">The List Monad</a></td></tr><tr><td><span class="tocsublinknumber">2.2.2<tt>&nbsp;</tt></span><a href="#(part._.The_.State_.Monad)" class="tocsubseclink" pltdoc="x">The State Monad</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#(part._.Other_.Utility_.Functions_.Forms)" class="tocsubseclink" pltdoc="x">Other Utility Functions/<span class="mywbr"> </span>Forms</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#(part._.Functions_.Values)" class="tocsubseclink" pltdoc="x">Functions/<span class="mywbr"> </span>Values</a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._bind))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">bind</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._return))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">return</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._zero))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">zero</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._plus))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">plus</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._list-bind))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">list-<wbr></wbr>bind</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._list-return))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">list-<wbr></wbr>return</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._list-plus))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">list-<wbr></wbr>plus</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._list-zero))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">list-<wbr></wbr>zero</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._the-list-monad))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">the-<wbr></wbr>list-<wbr></wbr>monad</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._the-identity-monad))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">the-<wbr></wbr>identity-<wbr></wbr>monad</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-return))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>return</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-promote))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>promote</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-promote-producer))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>promote-<wbr></wbr>producer</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-bind))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>bind</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-plus))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>plus</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-zero))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>zero</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._lift))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">lift</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._mapm))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">mapm</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._foldlm))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">foldlm</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._reducem))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">reducem</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#(part._.Structures)" class="tocsubseclink" pltdoc="x">Structures</a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._monad))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">monad</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-doublet))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>doublet</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-error))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>error</span></span></a></td></tr><tr><td><a href="#(def._((lib._functional/better-monads..rkt)._state-fail))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">state-<wbr></wbr>fail</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#(part._.Syntax)" class="tocsubseclink" pltdoc="x">Syntax</a></td></tr><tr><td><a href="#(form._((lib._functional/better-monads..rkt)._with-monad))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">with-<wbr></wbr>monad</span></span></a></td></tr><tr><td><a href="#(form._((lib._functional/better-monads..rkt)._mlet*))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">mlet*</span></span></a></td></tr><tr><td><a href="#(form._((lib._functional/better-monads..rkt)._monadic-do))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: functional/better-monads"><span class="RktSym">monadic-<wbr></wbr>do</span></span></a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#(part._.Conclusions)" class="tocsubseclink" pltdoc="x">Conclusions</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">Version: 5.1.3</span></div><h2><a name="(part._.Better_.Monads)"></a><a name="(mod-path._functional/better-monads)"></a>Better Monads</h2><p><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" pltdoc="x"><span class="RktSym">functional/better-monads</span></a><span class="RktPn">)</span></td></tr></table></p><p>This library is an attempt to facilitate pure functional programming
by providing a set of functions and special forms for working with
monads.  It also provides the definition of several common monads
extended in such a way as to make their use in dynamic languages more
convenient.  The user can define their own monads for later use as
well.</p><h3>1<tt>&nbsp;</tt><a name="(part._.Usage)"></a>Usage</h3><p>What follows is a brief tutorial on the usage of this library.</p><h4>1.1<tt>&nbsp;</tt><a name="(part._mlet_)"></a>mlet*</h4><p>The most important special form in the library is the <span class="RktSym">mlet*</span>
syntax, which is the "Schemeish" monadic binding form, roughly
equivalent to Haskell&rsquo;s "do" notation.</p><p>Monads allow you to extend the meaning of variable binding within an
<span class="RktSym">mlet*</span> expression, and hence <span class="RktSym">mlet*</span> is very similar to
<span class="RktSym"><a href="file:///home/toups/racket/doc/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let*))" class="RktStxLink" pltdoc="x">let*</a></span>, in that it takes a series of binding pairs and then
evaluates a body of expressions, as in a <span class="RktSym"><a href="file:///home/toups/racket/doc/reference/begin.html#(form._((quote._~23~25kernel)._begin))" class="RktStxLink" pltdoc="x">begin</a></span> form.</p><p>In fact, at the top level, <span class="RktSym">mlet*</span> behaves identically to
<span class="RktSym"><a href="file:///home/toups/racket/doc/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let*))" class="RktStxLink" pltdoc="x">let*</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">functional/better-monads</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">mlet*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>By default, <span class="RktSym">mlet*</span> performs its bindings in whatever monad is
stored in the lexical variable <span class="RktSym">current-monad</span>, which Better
Monads exports as the identity monad (also available in the variable
<span class="RktSym">the-identity-monad</span>).</p><p>One difference, which applies to all monads, is that Racket&rsquo;s built-in
"match" patterns can be substituted for the symbols in the binding
form.  For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">mlet*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktSym">q</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">101</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">q</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Will return <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">100</span><span class="stt"> </span><span class="RktVal">101</span><span class="RktVal">)</span>.</p><h4>1.2<tt>&nbsp;</tt><a name="(part._.Working_with_a_.Monad)"></a>Working with a Monad</h4><p>Besides extending <span class="RktSym"><a href="file:///home/toups/racket/doc/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let*))" class="RktStxLink" pltdoc="x">let*</a></span> with pattern matching, the library
doesn&rsquo;t do much until you start using monads other than
<span class="RktSym">the-identity-monad</span>.  Alternative monads are introduced using
the <span class="RktSym">in:</span> option in <span class="RktSym">mlet*</span>.  For instance:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:transparent</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">mlet*</span><span class="hspace">&nbsp;</span><span class="RktSym">in:</span><span class="hspace">&nbsp;</span><span class="RktSym">the-list-monad</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">d</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">return</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Will result in:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">c</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">doublet</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>And so on, to include all the combinations of the items bound to
<span class="RktSym">x</span> and <span class="RktSym">y</span>, which is the behavior of
<span class="RktSym">the-list-monad</span>.</p><p>Note the use of the function <span class="RktSym">return</span> in the body of the
<span class="RktSym">mlet*</span> expression.  In the context of an <span class="RktSym">mlet*</span>
expression, the symbosl <span class="RktSym">bind</span>, and <span class="RktSym">return</span> are bound
to the appropriate functions in the specified monad.  If the monad
also defines <span class="RktSym">plus</span> and/or <span class="RktSym">zero</span>, these will also be
appropriately bound.  Otherwise they will be bound to <span class="RktVal">#f</span>.  In
the lexical scope of an <span class="RktSym">mlet*</span> expression, the
<span class="RktSym">current-monad</span> will be bound to the monad specified after
<span class="RktSym">in:</span>.</p><h4>1.3<tt>&nbsp;</tt><a name="(part._.Defining_.Additional_.Monads)"></a>Defining Additional Monads</h4><p>The use may define her own monads by creating an instance of the
<span class="RktSym">monad</span> structure.  For instance, we might define the "maybe"
monad like this:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Just</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:transparent</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">None</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:transparent</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">maybe-return</span><span class="hspace">&nbsp;</span><span class="RktSym">item</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Just</span><span class="hspace">&nbsp;</span><span class="RktSym">item</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">maybe-bind</span><span class="hspace">&nbsp;</span><span class="RktSym">monadic-value</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">monadic-function</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/match.html#(form._((lib._racket/match..rkt)._match))" class="RktStxLink" pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">monadic-value</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">Just</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">monadic-function</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">None</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">monadic-value</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">the-maybe-monad</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">monad</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe-bind</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe-return</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Having done such, we may write:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">mlet*</span><span class="hspace">&nbsp;</span><span class="RktSym">in:</span><span class="hspace">&nbsp;</span><span class="RktSym">the-maybe-monad</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Just</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Just</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">return</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Which evaluates to <span class="RktPn">(</span><span class="RktSym">Just</span><span class="stt"> </span><span class="RktVal">21</span><span class="RktPn">)</span>.  We might also write:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">mlet*</span><span class="hspace">&nbsp;</span><span class="RktSym">in:</span><span class="hspace">&nbsp;</span><span class="RktSym">the-maybe-monad</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Just</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">None</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">z</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Just</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">return</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">z</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Which will evaluate to <span class="RktPn">(</span><span class="RktSym">None</span><span class="RktPn">)</span>.</p><p>In this example, we bound the monad to a symbol, but monads may be
specified anonymously.</p><h4>1.4<tt>&nbsp;</tt><a name="(part._.Lagniappe__.Bonus_.Features_)"></a>Lagniappe (Bonus Features)</h4><p>It is often useful to bind values non-monadically during a monadic
expression.  These can be introduced using the <span class="RktSym">is:</span> syntax.
For instance:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">mlet*</span><span class="hspace">&nbsp;</span><span class="RktSym">in:</span><span class="hspace">&nbsp;</span><span class="RktSym">the-list-monad</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">q</span><span class="hspace">&nbsp;</span><span class="RktSym">is:</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">return</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">q</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Will produce <span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">11</span><span class="stt"> </span><span class="RktSym">a</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">11</span><span class="stt"> </span><span class="RktSym">b</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span>.  And so on.
The symbol <span class="RktSym">q</span> is bound as in a <span class="RktSym"><a href="file:///home/toups/racket/doc/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))" class="RktStxLink" pltdoc="x">let</a></span> expression for all
expressions subsequent.  The binding symbol can also be a
<span class="RktSym"><a href="file:///home/toups/racket/doc/reference/match.html#(form._((lib._racket/match..rkt)._match))" class="RktStxLink" pltdoc="x">match</a></span> pattern.</p><h3>2<tt>&nbsp;</tt><a name="(part._.Other_.Forms_and_.Functions)"></a>Other Forms and Functions</h3><p>At the moment, the library provides a few extra functions and
features.</p><h4>2.1<tt>&nbsp;</tt><a name="(part._monadic-do)"></a>monadic-do</h4><p>The form <span class="RktSym">monadic-do</span> provides an alternative, more
Haskell-ish, monadic binding form.  Each expression (except the last)
in the body of a <span class="RktSym">monadic-do</span> must be either a binding
expression:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">pattern</span><span class="hspace">&nbsp;</span><span class="RktSym">&lt;-</span><span class="hspace">&nbsp;</span><span class="RktSym">monadic-value</span><span class="RktPn">)</span></p></blockquote><p>A "letting" expression:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">pattern</span><span class="hspace">&nbsp;</span><span class="RktSym">is:</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="RktPn">)</span></p></blockquote><p>Or an expression resulting in a monadic value.  The last expression in
a monadic-do form can&rsquo;t bind or let any variables, but must evaluate
to a monadic value.  This version of the form might be more useful for
monads like the state monad which have many monadic values for which
the resulting binding isn&rsquo;t important.</p><p>Eg:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state-push</span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state-doublet</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">no-one-cares</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._cons))" class="RktValLink" pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="hspace">&nbsp;</span><span class="RktSym">state</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">state-pop</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state-doublet</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._car))" class="RktValLink" pltdoc="x">car</a></span><span class="hspace">&nbsp;</span><span class="RktSym">state</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._cdr))" class="RktValLink" pltdoc="x">cdr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">state</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">monadic-do</span><span class="hspace">&nbsp;</span><span class="RktSym">in:</span><span class="hspace">&nbsp;</span><span class="RktSym">the-state-monad</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state-push</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state-push</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">&lt;-</span><span class="hspace">&nbsp;</span><span class="RktSym">state-pop</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state-push</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>That is, we don&rsquo;t care about the value returned by <span class="RktSym">state-push</span>
for binding in subsequent expressions.  This form threads our values
through the monad, but lets us avoid the noise of providing dummy
variable names.  Bindings to actual symbols is indicated specifically
by <span class="RktSym">&lt;-</span> for monadic binding and <span class="RktSym">is:</span> for regular
binding.</p><h4>2.2<tt>&nbsp;</tt><a name="(part._.Bundled_.Monads)"></a>Bundled Monads</h4><p>The library comes with several monads pre-defined.  We&rsquo;ve seen most of
them already, but its worth remarking on a few peculiarities.</p><h5>2.2.1<tt>&nbsp;</tt><a name="(part._.The_.List_.Monad)"></a>The List Monad</h5><p>The list monad behaves just like the list monad in Haskell or any
other language, in that bind is essentially "map-cat".  However,
unlike in Haskell, the list monad in this library will "return"
non-list values if they appear where a list should be.  You can say,
eg:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">mlet*</span><span class="hspace">&nbsp;</span><span class="RktSym">in:</span><span class="hspace">&nbsp;</span><span class="RktSym">the-list-monad</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">return</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara">When "bind" encounters "4" either in a place where a monadic value or
monadic function should be, it replaces it with the "right" value
(either <span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">4</span><span class="RktPn">)</span> or <span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="RktStxLink" pltdoc="x">_</a></span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span>,
respectively).  If you want to return a list, you must <span class="RktSym">return</span>
it explicitely.  </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Being able to squeeze values into our
monad like this is a nice benefit of working with monads in a language
with run-time type-checking.</p></blockquote></blockquote></blockquote></div></p><h5>2.2.2<tt>&nbsp;</tt><a name="(part._.The_.State_.Monad)"></a>The State Monad</h5><p>The state monad is useful for constructing functions of state out of
smaller state functions.  Monadic values in this monad are functions
which take a state and return a <span class="RktSym">state-doublet</span> struct.  The
first part of this doublet is the "proper return value" of the state
function, which is the value bound in binding expressions.  The second
value is the modified state.</p><p>Like <span class="RktSym">the-list-monad</span>, <span class="RktSym">the-state-monad</span> makes an
attempt treat unexpected values correctly.  Literals are
<span class="RktSym">return</span>ed into the monad if they appear where a monadic value
should be.  Functions can return a simple value, rather than a
state-doublet, in which case the bind assumes that the intent was to
simple insert that value into the monad without modifying the
accumulating state.</p><p>State functions may also return either a <span class="RktSym">state-fail</span> struct or
a <span class="RktPn">(</span><span class="RktSym">state-error</span><span class="stt"> </span><span class="RktSym">error-value</span><span class="RktPn">)</span> struct to indicate failure.  Such
return values short-circuit all further state function bindings.  For
the state monad, then, <span class="RktSym">state-fail</span> is the monadic zero and
<span class="RktSym">state-error</span> allows the monad to report errors.</p><h4>2.3<tt>&nbsp;</tt><a name="(part._.Other_.Utility_.Functions_.Forms)"></a>Other Utility Functions/Forms</h4><p>It is often convenient to "lift" a function into a monad.  This is
provided for by a suite of lift functions.  Because functions have
variable arity in Racket, you must specifiy the number of arguments to
lift over, although this can be specified at run time (unlike the
Clojure library), up to 20 arguments.</p><p>Eg:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">list+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lift</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">the-list-monad</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">list+</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Short-cut functions of the form <span class="RktSym">lift1</span>,<span class="RktSym">lift2</span> and so
on are also exported.</p><p>The library also exports <span class="RktSym">mapm</span> and <span class="RktSym">foldlm</span>.  The
former takes a monadic function and a list of values and returns a
monadic function which returns the list resulting from monadically
binding those values through the monad.</p><p>The latter takes a monadic function, an initial state, and a list of
values and returns a monadic function which folds over those values in
the monad, returning a monadic value which is the result of that
folding.  The function <span class="RktSym">reducem</span> is the same, but assumes the
initial value is the <span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._car))" class="RktValLink" pltdoc="x">car</a></span> of the list and folds over the
<span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._cdr))" class="RktValLink" pltdoc="x">cdr</a></span>.</p><h3>3<tt>&nbsp;</tt><a name="(part._.Functions_.Values)"></a>Functions/Values</h3><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._bind))"></a><a name="(def._((lib._functional/better-monads..rkt)._bind))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">bind</span></span><span class="hspace">&nbsp;</span><span class="RktVar">monadic-value</span><span class="hspace">&nbsp;</span><span class="RktVar">monadic-function</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">monadic-value</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">monadic-value</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">monadic-function</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>Binds a <span class="RktSym">monadic-value</span> to the free variable in the calculation
represented by the <span class="RktSym">monadic-function</span>.  User defined binds might
coerce either argument into an appropriate form, hence the weak contracts.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._return))"></a><a name="(def._((lib._functional/better-monads..rkt)._return))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">return</span></span><span class="hspace">&nbsp;</span><span class="RktVar">item</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">monadic-value</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">item</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>Inserts <span class="RktSym">value</span> into the currently operating monad.</p><p><table cellspacing="0" class="boxed"><tr><td><a name="(dep._((lib._functional/better-monads..rkt)._zero))"></a><a name="(def._((lib._functional/better-monads..rkt)._zero))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">zero</span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>The currently defined monadic-zero, <span class="RktVal">#f</span> if the zero is not defined.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._plus))"></a><a name="(def._((lib._functional/better-monads..rkt)._plus))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">plus</span></span><span class="hspace">&nbsp;</span><span class="RktVar">mval1</span><span class="hspace">&nbsp;</span><span class="RktVar">mval2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mval</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mval1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mval2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>Combines two monadic values, if the operating is meaningful in the
current monad.  Will be <span class="RktVal">#f</span> otherwise.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._list-bind))"></a><a name="(def._((lib._functional/better-monads..rkt)._list-bind))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">list-bind</span></span><span class="hspace">&nbsp;</span><span class="RktVar">lst</span><span class="hspace">&nbsp;</span><span class="RktVar">list-fun</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">lst</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">lst</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">list-fun</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>The bind operation for the list monad.  Applies the function <span class="RktSym">list-fun</span> to
each item in <span class="RktSym">lst</span>, returns the concatenated result as a single list.
Non-list values are wrapped in lists if encountered.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._list-return))"></a><a name="(def._((lib._functional/better-monads..rkt)._list-return))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">list-return</span></span><span class="hspace">&nbsp;</span><span class="RktVar">item</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">item-in-list</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">item</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._list-plus))"></a><a name="(def._((lib._functional/better-monads..rkt)._list-plus))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">list-plus</span></span><span class="hspace">&nbsp;</span><span class="RktVar">a</span><span class="hspace">&nbsp;</span><span class="RktVar">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">b</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span></td></tr></table></p><p>The list-monad plus procedure, equivalent to <span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._append))" class="RktValLink" pltdoc="x">append</a></span>.</p><p><table cellspacing="0" class="boxed"><tr><td><a name="(dep._((lib._functional/better-monads..rkt)._list-zero))"></a><a name="(def._((lib._functional/better-monads..rkt)._list-zero))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">list-zero</span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span></td></tr></table></p><p>Is the empty list.</p><p><table cellspacing="0" class="boxed"><tr><td><a name="(dep._((lib._functional/better-monads..rkt)._the-list-monad))"></a><a name="(def._((lib._functional/better-monads..rkt)._the-list-monad))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">the-list-monad</span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">monad?</span></td></tr></table></p><p>The list monad.</p><p>The return operation for the list monad.  Puts <span class="RktSym">item</span> into a list.</p><p><table cellspacing="0" class="boxed"><tr><td><a name="(dep._((lib._functional/better-monads..rkt)._the-identity-monad))"></a><a name="(def._((lib._functional/better-monads..rkt)._the-identity-monad))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">the-identity-monad</span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">monad?</span></td></tr></table></p><p>The default monad, which does nothing.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._state-return))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-return))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-return</span></span><span class="hspace">&nbsp;</span><span class="RktVar">item</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">state-function</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-doublet?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">item</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>The state monad return operation.  Creates a state function which
leaves its input state unmodified and inserts <span class="RktSym">item</span> into
the proper return value slot of a state doublet.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._state-promote))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-promote))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-promote</span></span><span class="hspace">&nbsp;</span><span class="RktVar">object</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">state-function</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">object</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>This function promotes non-monadic values into
monadic values in the state monad.  This is applied
to objects before being passed to bind, so that the
user can specify simple values instead of wrapping
them with return.</p><p>Handles doublets, errors and failures correctly.  "Returns"
all other values into the state monad.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._state-promote-producer))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-promote-producer))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-promote-producer</span></span><span class="hspace">&nbsp;</span><span class="RktVar">object</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">state-function-function</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">object</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>Similar to <span class="RktSym">state-promote</span> but wraps
object into another function so that the result
is a monadic function.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._state-bind))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-bind))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-bind</span></span><span class="hspace">&nbsp;</span>[<span class="RktVar">val</span>]<span class="hspace">&nbsp;</span><span class="RktVar">fun</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">val</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td><td><span class="hspace">&nbsp;</span></td><td>=</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">fun</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></p><p>The state-monad bind operation.  Returns a new state function
which applies <span class="RktSym">val</span> to the incoming state, extracts
the proper return value from the doublet, and creates and applies
a new state function to the new state.  If either a <span class="RktSym">state-error</span>
or <span class="RktSym">state-fail</span> is encountered, it is passed through.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._state-plus))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-plus))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-plus</span></span><span class="hspace">&nbsp;</span><span class="RktVar">sf1</span><span class="hspace">&nbsp;</span><span class="RktVar">sf2</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">sf</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">sf1</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">sf2</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-doublet?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-error?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></p><p>Combines two state functions into a third, which applies <span class="RktSym">sf1</span>,
ignores its output, and then applies and returns the result of <span class="RktSym">sf2</span>.
Errors/failures are handled correctly.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0" class="argcontract"><tr><td><a name="(dep._((lib._functional/better-monads..rkt)._state-zero))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-zero))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-zero</span></span></td><td><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">state-fail?</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></p><p>The zero of the state monad.  Always returns a <span class="RktSym">state-fail</span> structure.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._lift))"></a><a name="(def._((lib._functional/better-monads..rkt)._lift))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">lift</span></span><span class="hspace">&nbsp;</span><span class="RktVar">n</span><span class="hspace">&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span><span class="RktVar">monad</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lf</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/procedures.html#(def._((quote._~23~25kernel)._procedure~3f))" class="RktValLink" pltdoc="x">procedure?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">n</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._and/c))" class="RktValLink" pltdoc="x">and/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/number-types.html#(def._((quote._~23~25kernel)._integer~3f))" class="RktValLink" pltdoc="x">integer?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/number-types.html#(def._((quote._~23~25kernel)._positive~3f))" class="RktValLink" pltdoc="x">positive?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/procedures.html#(def._((quote._~23~25kernel)._procedure~3f))" class="RktValLink" pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">monad?</span></td></tr></table></p><p>Lifts <span class="RktSym">f</span> into the monad <span class="RktSym">monad</span>.  The number of arguments
to lift must be provided in <span class="RktSym">n</span>.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._mapm))"></a><a name="(def._((lib._functional/better-monads..rkt)._mapm))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">mapm</span></span><span class="hspace">&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span><span class="RktVar">lists</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">monadic-value</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">monad?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/procedures.html#(def._((quote._~23~25kernel)._procedure~3f))" class="RktValLink" pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">lists</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span></td></tr></table></p><p>Create a monadic value in the specified <span class="RktSym">monad</span> by applying
f to each of the arguments specified in <span class="RktSym">lists</span> in turn.  Return
a monadic value containing a list of the results.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._foldlm))"></a><a name="(def._((lib._functional/better-monads..rkt)._foldlm))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">foldlm</span></span><span class="hspace">&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span><span class="RktVar">init</span><span class="hspace">&nbsp;</span><span class="RktVar">lst</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">monadic-value</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">monad?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">item</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">acc</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">result</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">init</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">lst</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span></td></tr></table></p><p>Returns a monadic value in the <span class="RktSym">monad</span> obtained
by applying the monadic function <span class="RktSym">f</span> iteratively
to the items in list and an accumulator.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._reducem))"></a><a name="(def._((lib._functional/better-monads..rkt)._reducem))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">reducem</span></span><span class="hspace">&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span><span class="RktVar">lst</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">monadic-value</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">monad?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">item</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">acc</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">result</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">lst</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._list~3f))" class="RktValLink" pltdoc="x">list?</a></span></td></tr></table></p><p>Like <span class="RktSym">foldlm</span> but <span class="RktSym"><a href="file:///home/toups/racket/doc/reference/createclass.html#(form._((lib._racket/private/class-internal..rkt)._init))" class="RktStxLink" pltdoc="x">init</a></span> is taken to be
<span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/pairs.html#(def._((quote._~23~25kernel)._car))" class="RktValLink" pltdoc="x">car</a></span><span class="stt"> </span><span class="RktSym">lst</span><span class="RktPn">)</span> and the tail of the list is folded over.</p><h3>4<tt>&nbsp;</tt><a name="(part._.Structures)"></a>Structures</h3><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="stt"> </span><a name="(dep._((lib._functional/better-monads..rkt)._monad-zero))"></a><a name="(def._((lib._functional/better-monads..rkt)._monad-zero))"></a><a name="(dep._((lib._functional/better-monads..rkt)._monad-plus))"></a><a name="(def._((lib._functional/better-monads..rkt)._monad-plus))"></a><a name="(dep._((lib._functional/better-monads..rkt)._monad-return))"></a><a name="(def._((lib._functional/better-monads..rkt)._monad-return))"></a><a name="(dep._((lib._functional/better-monads..rkt)._monad-bind))"></a><a name="(def._((lib._functional/better-monads..rkt)._monad-bind))"></a><a name="(dep._((lib._functional/better-monads..rkt)._monad~3f))"></a><a name="(def._((lib._functional/better-monads..rkt)._monad~3f))"></a><a name="(dep._((lib._functional/better-monads..rkt)._struct~3amonad))"></a><a name="(def._((lib._functional/better-monads..rkt)._struct~3amonad))"></a><a name="(dep._((lib._functional/better-monads..rkt)._monad))"></a><a name="(def._((lib._functional/better-monads..rkt)._monad))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">monad</span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">bind</span><span class="stt"> </span><span class="RktSym">return</span><span class="stt"> </span><span class="RktSym">plus</span><span class="stt"> </span><span class="RktSym">zero</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">bind</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">return</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">plus</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Function_Contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">zero</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>The structure representing a monad.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="stt"> </span><a name="(dep._((lib._functional/better-monads..rkt)._state-doublet-state))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-doublet-state))"></a><a name="(dep._((lib._functional/better-monads..rkt)._state-doublet-proper-return-value))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-doublet-proper-return-value))"></a><a name="(dep._((lib._functional/better-monads..rkt)._state-doublet~3f))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-doublet~3f))"></a><a name="(dep._((lib._functional/better-monads..rkt)._struct~3astate-doublet))"></a><a name="(def._((lib._functional/better-monads..rkt)._struct~3astate-doublet))"></a><a name="(dep._((lib._functional/better-monads..rkt)._state-doublet))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-doublet))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-doublet</span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">proper-return-value</span><span class="stt"> </span><span class="RktSym">state</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">proper-return-value</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">state</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>Represents a value/state pair for the state monad.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="stt"> </span><a name="(dep._((lib._functional/better-monads..rkt)._state-error-last-state))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-error-last-state))"></a><a name="(dep._((lib._functional/better-monads..rkt)._state-error-error-string))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-error-error-string))"></a><a name="(dep._((lib._functional/better-monads..rkt)._state-error~3f))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-error~3f))"></a><a name="(dep._((lib._functional/better-monads..rkt)._struct~3astate-error))"></a><a name="(def._((lib._functional/better-monads..rkt)._struct~3astate-error))"></a><a name="(dep._((lib._functional/better-monads..rkt)._state-error))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-error))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-error</span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">error-string</span><span class="stt"> </span><span class="RktSym">last-state</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">error-string</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">last-state</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></p><p>Represents a state-monad error condition.  The error string contains
information about the error, while <span class="RktSym">last-state</span> is the last
state before the error.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span><span class="stt"> </span><a name="(dep._((lib._functional/better-monads..rkt)._state-fail~3f))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-fail~3f))"></a><a name="(dep._((lib._functional/better-monads..rkt)._struct~3astate-fail))"></a><a name="(def._((lib._functional/better-monads..rkt)._struct~3astate-fail))"></a><a name="(dep._((lib._functional/better-monads..rkt)._state-fail))"></a><a name="(def._((lib._functional/better-monads..rkt)._state-fail))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">state-fail</span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>Completely dumb state error condition.  Provides no error information.
Is the state monad&rsquo;s zero.</p><h3>5<tt>&nbsp;</tt><a name="(part._.Syntax)"></a>Syntax</h3><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._with-monad))"></a><a name="(form._((lib._functional/better-monads..rkt)._with-monad))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">with-monad</span></span><span class="hspace">&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></p><p>Introduces a context for the expressions in <span class="RktSym">body</span><span class="stt"> </span><span class="RktSym"><a href="file:///home/toups/racket/doc/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span> in which
the appropriate values, <span class="RktSym">bind</span>, <span class="RktSym">plus</span>, <span class="RktSym">zero</span>, <span class="RktSym">return</span>,
and <span class="RktSym">current-monad</span> are bound to the values specified in <span class="RktSym">monad</span>.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._mlet*))"></a><a name="(form._((lib._functional/better-monads..rkt)._mlet*))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">mlet*</span></span><span class="hspace">&nbsp;</span><span class="RktSym">in:</span><span class="hspace">&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">binding</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></p><p>Monadic binding expression.  Each binder must be either a <span class="RktPn">(</span><span class="RktSym">pattern</span><span class="stt"> </span><span class="RktSym">value</span><span class="RktPn">)</span>
pair, which binds and destructures monadically, or a <span class="RktPn">(</span><span class="RktSym">pattern</span><span class="stt"> </span><span class="RktSym">is:</span><span class="stt"> </span><span class="RktSym">value</span><span class="RktPn">)</span>
triple which binds and destructures non-monadically.  The body is finally evaluated,
returning the last value.  This is almost always necessarily a monadic value.</p><p>The <span class="RktSym">in:</span><span class="stt"> </span><span class="RktSym">monad</span> part may  be neglected, in which case the current lexical
<span class="RktSym">current-monad</span> is used.</p><p><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._functional/better-monads..rkt)._monadic-do))"></a><a name="(form._((lib._functional/better-monads..rkt)._monadic-do))"></a><span title="Provided from: functional/better-monads"><span class="RktSym">monadic-do</span></span><span class="hspace">&nbsp;</span><span class="RktVar">in:</span><span class="hspace">&nbsp;</span><span class="RktVar">monad</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></p><p>Haskell-flavored monadic expression.  Each <span class="RktSym">expr</span> must be either
a monadic binding expression, like <span class="RktPn">(</span><span class="RktSym">pattern</span><span class="stt"> </span><span class="RktSym">&lt;-</span><span class="stt"> </span><span class="RktSym">value</span><span class="RktPn">)</span> which introduces
the bindings specified by <span class="RktSym">pattern</span> through the monad <span class="RktSym">monad</span>,
a regular binding expression like <span class="RktPn">(</span><span class="RktSym">pattern</span><span class="stt"> </span><span class="RktSym">is:</span><span class="stt"> </span><span class="RktSym">value</span><span class="RktPn">)</span> which does
a plain bind, or an expression resulting in a monadic value.  The final <span class="RktSym">expr</span>
must be a monadic value, not a binding form.</p><p>As in <span class="RktSym">mlet*</span>, the <span class="RktSym">in:</span><span class="stt"> </span><span class="RktSym">monad</span> may be neglected, in which
case the current lexically bound <span class="RktSym">current-monad</span> is used.</p><h3>6<tt>&nbsp;</tt><a name="(part._.Conclusions)"></a>Conclusions</h3><p>This should be enough to get you going.  Enjoy the monads!</p></div></div><div id="contextindicator">&nbsp;</div></body></html>